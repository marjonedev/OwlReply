<% unless @emailaccount.authenticated %>
  <div class="row">
    <div class="col-md-1"></div>
    <div class="col-md-10 authentication">
      <div class="style-msg style-msg-light" style="background-color: #333;">
        <div class="sb-msg">
          <%= link_to 'Connect your email account', '#', class: 'btn-connect button button-3d button-mini button-rounded button-white button-light', remote: true %>
          You need to connect your email account in order for us to be able to create an automated replies for you.
        </div>
      </div>
    </div>
    <div class="col-md-1"></div>
  </div>
<% end %>

<% unless @emailaccount.authenticated %>
  <% content_for :modals_includes do %>
    <div class="modal fade" id="ConnectEmailAccount" tabindex="-1" role="dialog" aria-labelledby="ConnectEmailAccount" aria-hidden="true">
      <div class="modal-dialog modal-md">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title text-center" style="width: 100%">Connect Your Email Account</h4>
          </div>
          <div class="modal-body">
            <%= form_for @emailaccount, url: connect_emailaccount_path, remote:true, html:{class: 'nobottommargin'} do |f| %>
              <div class="form-group">
                <label for="emailProvider">Email Provider</label>
                <select class="form-control" id="emailProvider" name="emailaccount[email_provider]">
                  <option value="google">Google</option>
                  <option value="other">Others</option>
                </select>
              </div>
              <div id="smtpSettings" style="display:none">
                <div class="form-group">
                  <label>Email</label>
                  <%= f.text_field :address, class: 'form-control', readonly: 'readonly' %>
                </div>
                <div class="form-group">
                  <label>Server</label>
                  <%= f.text_field :smtp_host, class: 'form-control' %>
                </div>
                <div class="form-group">
                  <label>Password</label>
                  <%= f.text_field :password, class: 'form-control' %>
                </div>
                <div class="form-group">
                  <label for="emailProvider">Encryption Method</label>
                  <select class="form-control" id="emailProvider" name="emailaccount[smtp_encryption_type]">
                    <option value="none">None</option>
                    <option value="tls">TLS</option>
                    <option value="ssl">SSL</option>
                    <option value="starttls">STARTTLS</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Port</label>
                  <%= f.text_field :smtp_port, class: 'form-control' %>
                </div>
              </div>
              <div class="form-group">
                <button type="submit" class="button button-large button-rounded float-left">Connect</button>
                <button type="button" data-dismiss="modal" class="button button-white button-light button-large button-rounded float-right">Cancel</button>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <% content_for :javascript_footer_includes do %>
    <script type="text/javascript">
        $(function () {
            $('.btn-connect').on('click', function (e) {
                e.preventDefault();
                $('#ConnectEmailAccount').modal('show');
                return false;
            });

            $('#emailProvider').on('change', function () {
                var value = $(this).val();
                if (value == 'other'){
                    $('#smtpSettings').show();
                }else{
                    $('#smtpSettings').hide();
                }
            });

            $('#ConnectEmailAccount').on('hidden.bs.modal', function () {

            });
        });
    </script>
  <% end %>
<% end %>