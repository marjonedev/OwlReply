$('span.last-check').text('<%= @emailaccount.last_checked_at %>');

$('a.check_btn')
    .html('<i class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></i> Queued for next check...')
    .addClass('disabled')
    .attr('disabled', 'disabled');

var checkInterval = setInterval(function() {
    $.ajax({
        url: "<%= status_emailaccount_path(@emailaccount, :format => :json) %>",
        type: "GET",
        contentType: "application/json",
        success: function(data){
            if(data.data != null){
                $('span.last-check').text(data.data);
                clearInterval(checkInterval);

                $('a.check_btn')
                    .text('Check Again Now')
                    .removeClass('disabled')
                    .removeAttr('disabled');
            }
        }
    });
}, 30000);